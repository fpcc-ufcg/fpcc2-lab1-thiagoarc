---
title: "FPCC2 - Laboratório 1"
author: "Thiago André Rego Chaves"
date: "25/03/2022"
output: html_document
---

# Questões do Laboratório 1

```{r pacotes}
library(ggplot2)
library(scales)
source("../code/lab1.R")
```
  
## Questão 1
  
* Calcule média e desvio padrão da idade e nível de interesse. As métricas contendos as métricas calculadas para idade e devem ser apresentadas de forma ordenada, da maior idade para a menor. Além de apresentar no relatório, os resultados devem ser salvos em um arquivo csv, que deve ser adicionado ao repositório.

```{r calculo da questão 1}

```

## QUestão 2
* Qual o curso com maior valor médio de idade? Discutir os resultados com base nos dados disponíveis em termos de representatividade. 

```{r calculo da questão 2}
q1 <- turma_fpcc2 %>% 
select(tipo_curso, idade) %>% 
mutate(idade_int = as.integer(gsub("[a-z]|\\.", "", idade))) %>%
group_by(tipo_curso) %>% 
summarise(max(idade_int))

print(q1)

print("O curso com maior valor médio de idade é: ")

print(q1 %>% top_n(1))

```

## Questão 3
* Crie um gráfico que mostra a idade média para cada curso. Apresente o gráfico e discuta os resultados no relatório. O gráfico também deve ser salvo em uma imagem no formato png, que deve ser adicionada ao repositório. 

```{r calculo da questão 3}

q1 <- turma_fpcc2 %>% 
select(tipo_curso, idade) %>% 
mutate(idade_int = as.integer(gsub("[a-z]|\\.", "", idade))) %>%
group_by(tipo_curso) %>% 
summarise(media = mean(idade_int))

print(q1)

ggplot(q1, aes(tipo_curso, media, fill = tipo_curso)) + 
  geom_bar(stat = "identity") + 
  xlab("Tipo de curso") +
  ylab("Idade Média") + 
  theme_bw(base_size = 14) + 
  theme(legend.position = "None")

```

## Questão 4
* Crie um gráfico que mostra o percentual de alunos para cada estado de origem. Apresente o gráfico e discuta os resultados no relatório. O gráfico também deve ser salvo em uma imagem no formato png, que deve ser adicionada ao repositório.  
```{r calculo da questão 4}

q2 <- turma_fpcc2 %>% select(uf) %>% 
  mutate(uf = case_when(
    uf == "Opção 1" ~ "NA",
    uf == "Paraiba" ~ "PB", 
    uf == "Paraíba" ~ "PB",
    uf == "PB (Campina Grande)" ~ "PB",
    uf == "Acre" ~ "AC",
    uf == "Alagoas" ~ "AL",
    uf == "Pernambuco, mas moro em Campina Grande há mais de 20 anos" ~ "PE",
    TRUE ~ uf
  )) %>% 
  filter(!is.na(uf)) %>%
  count(uf) %>% 
  arrange(-n, uf)

print(q2)


```